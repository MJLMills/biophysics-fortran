MODULE CoordinateFunctions
IMPLICIT NONE

  PURE REAL(8) FUNCTION EuclideanDistance(origin,coords,n) result(r)

  real(8), intent(in) :: origin(n), coords(n)
  integer :: n

    r = dsqrt(pdotq(coords(:) - origin(:),n))
  
  END FUNCTION EuclideanDistance
!*
  PURE REAL(8) FUNCTION EuclideanDistance(vector,n) result(r)

  real(8), intent(in) :: vector(n)
  integer :: n, i
  
    r = dsqrt(pdotq(vector,vector,n))
  
  END FUNCTION EuclideanDistance
!*
  PURE REAL(8) FUNCTION DotProduct(p,q,n), result(pdotq)
  
  real(8), intent(in) :: p(n), q(n)
  integer :: n
  
    do i = 1, n
      pdotq = pdotq + ( p(i) * q(i) )
    enddo
  
  END FUNCTION DotProduct
!*  
  PURE REAL(8) FUNCTION DotProduct(p,n), result pdotp
  
  real(8), intent(in) :: q(n)
  integer :: n
  
    do i = 1, n
      pdotp = pdotp + q(i) * q(i)
    enddo
  
  END FUNCTION DotProduct
  
END MODULE CoordinateFunctions
